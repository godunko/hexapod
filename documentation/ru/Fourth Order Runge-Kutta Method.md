# Метод Рунге-Кутта четвёртого порядка

## Решение простого дифференциального уравнения

Существует несколько способов расчёта коэффициентов, здесь используется чаще встречающийся в литературе.

Известны:
 * уравнение первой производной искомой функции;
 * значение искомой функции в начальной точке.

$$
\begin{cases}
\frac{dy(t)}{dt} = y'(t) = f(y(t), t)
\\
y(t_0) = y_0
\end{cases}
$$

Необходимо найти значение функции в точке $t_1$.

Вычисление производится по формулам:

$$
\begin{array}{l}
h = t_1 - t_0
\\
k_1 = f(y(t_0), t_0)
\\
k_2 = f(y(t_0) + k_1 \frac{h}{2}, t_0 + \frac{h}{2})
\\
k_3 = f(y(t_0) + k_2 \frac{h}{2}, t_0 + \frac{h}{2})
\\
k_4 = f(y(t_0) + k_3 h), t_0 + h)
\\
y(t_1) = y(t_0) + \frac{k_1 + 2k_2 + 2k_3 + k_4}{6} h
\end{array}
$$

### Программирование

Для программирования задача заключается в наличии некоторой функции

$$
\frac{dy}{dt} = f_dy(y_i, t_i)
$$

а так же значения переменных $y_i$ и $t_i$ на $i$-ом шаге, и величины шага $h$.

Тогда ход вычислений будет выглядеть как

$$
\begin{array}{l}
k_1 := f_dy(y_i, t_i)
\\
k_2 := f_dy(y_i + k_1 \frac{h}{2}, t_i + \frac{h}{2})
\\
k_3 := f_dy(y_i + k_2 \frac{h}{2}, t_i + \frac{h}{2})
\\
k_4 := f_dy(y_i + k_3 h, t_i + h)
\\
\\
t_{i+1} := t_i + h
\\
y_{i+1} := y_i + \frac{k_1 + 2 k_2 + 2 k_3 + k_4}{6} h
\end{array}
$$

$y_{i+1}$ и есть значение искомой функции в следующей точке аппроксимации $t_{i+1}$.

## Система из двух дифференциальных уравнений

Решается аналогично, коэффициенты вычисляются для каждой из функций.

### Программирование

Дано две функции, составляющие систему дифференциальных уравнений:

$$
\begin{cases}
\frac{dx}{dt} = f_dx(x_i, y_i, t_i)
\\
\frac{dy}{dt} = f_dy(x_i, y_i, t_i)
\end{cases}
$$

значения переменных $x_i$, $y_i$ и $t_i$ на $i$-ом шаге, и величина шага $h$.

Тогда вычисление выполняется как:

$$
\begin{array}{l}
k_{1x} := f_dx(x_i, y_i, t_i)
\\
k_{1y} := f_dy(x_i, y_i, t_i)
\\
k_{2x} := f_dx(x_i + k_{1x} \frac{h}{2}, y_i + k_{1y} \frac{h}{2}, t_i + \frac{h}{2})
\\
k_{2x} := f_dy(x_i + k_{1x} \frac{h}{2}, y_i + k_{1y} \frac{h}{2}, t_i + \frac{h}{2})
\\
k_{3x} := f_dx(x_i + k_{2x} \frac{h}{2}, y_i + k_{2y} \frac{h}{2}, t_i + \frac{h}{2})
\\
k_{3y} := f_dy(x_i + k_{2x} \frac{h}{2}, y_i + k_{2y} \frac{h}{2}, t_i + \frac{h}{2})
\\
k_{4x} := f_dx(x_i + k_{3x} h, y_i + k_{3y} h, t_i + h)
\\
k_{4y} := f_dy(x_i + k_{3x} h, y_i + k_{3y} h, t_i + h)
\\
\\
t_{i+1} := t_i + h
\\
x_{i+1} := x_i + \frac{k_{1x} + 2 k_{2x} + 2 k_{3x} + k_{4x}}{6} h
\\
y_{i+1} := y_i + \frac{k_{1y} + 2 k_{2y} + 2 k_{3y} + k_{4y}}{6} h
\end{array}
$$

## Применение для аппроксимации осциллятора Хопфа

Использование метода Рунге-Кутта четвёртого порядка позволяет хорошо сгладить генерируемые осциллятором Хопфа значения.
Для сглаживания используется алгоритм описанный выше для систем дифференциальных уравнений, однако в формулах отсутствует параметр $t$, а следовательно его не нужно вычислять.
